<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mikes Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-section">
                <img src="https://mikesjustformen.nl/wp-content/uploads/2022/02/Mikes-just-for-men-Logo-wit.svg" alt="Mike's Just For Men" class="logo-image">
            </div>
            <h1>Mikes Tool</h1>
        </div>
        <nav class="main-tabs">
            <button id="tabExporter" class="main-tab active">Exporter</button>
            <button id="tabMapping" class="main-tab">Mapping</button>
            <button id="tabConverter" class="main-tab">Converter</button>
        </nav>
    </header>

    <main>
        <!-- EXPORTER TAB CONTENT -->
        <div id="exporterTabContent">
            <div class="card">
                <p class="card-title">Kies een .csv of .xlsx/.xls bestand</p>
                <input type="file" id="csvFileInput" accept=".csv,.xlsx,.xls">
                <div class="tabs-container" id="tabsContainer"></div>
            </div>

            <div id="exportControls">
                <div class="card">
                    <div class="controls-top">
                        <div class="controls-left">
                            <button id="reloadButton">Herlaad Bestand</button>
                            <label><input type="checkbox" id="masterCheckbox"> Alles selecteren</label>
                            <label for="delimiter">Seperator:</label>
                            <select id="delimiter">
                                <option value=";" selected>Puntkomma (;)</option>
                                <option value=",">Komma (,)</option>
                                <option value="\t">Tab</option>
                            </select>
                        </div>
                        <div class="controls-right">
                            <button id="exportButton">Exporteer Alle Rijen</button>
                            <button id="exportMarkedButton">Exporteer Gemarkeerde Rijen</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="table-container" id="tableContainer">
                    <table id="csvTable">
                        <thead></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <div class="info-message" id="infoMessage">
                    Selecteer een bestand om te beginnen
                </div>
            </div>
        </div>

        <!-- CONVERTER TAB CONTENT -->
        <div id="converterTabContent" style="display:none;">
            <div class="card">
                <p class="card-title">PDF naar Excel converter</p>
                <input type="file" id="pdfFileInput" accept="application/pdf">
            </div>
            
            <div id="pdfVisualPreviewContainer" class="card" style="display:none;">
                <p class="card-title">PDF Preview</p>
                <div id="pdfVisualPreview" style="border: 1px solid #e0e0e0; border-radius: 6px; overflow: auto; max-height: 600px; background: #f5f5f5;"></div>
                <div style="margin-top: 16px; display: flex; gap: 12px; align-items: center;">
                    <button id="convertPdfBtn">Converteer naar Excel</button>
                    <span id="pdfPageInfo" style="color: #7f8c8d; font-size: 14px;"></span>
                </div>
            </div>
            
            <div id="pdfDataPreviewContainer" class="card" style="display:none;">
                <p class="card-title">Data Preview (GeÃ«xtraheerde tabel)</p>
                <div id="pdfDataPreview" style="margin: 18px 0;"></div>
                <button id="downloadExcelBtn" disabled>Download als Excel</button>
            </div>
        </div>

        <!-- MAPPING TAB CONTENT -->
        <div id="mappingTabContent" style="display:none;">
            <div class="mapping-header-bar">
                <button id="mapFilesButton" disabled>Map Files</button>
            </div>

            <div class="mapping-flex-group">
                <div class="card mapping-file-block">
                    <span class="mapping-file-label">Bestand 1</span>
                    <input type="file" id="mappingFileInput1" accept=".csv,.xlsx,.xls">
                    <label for="mappingDelimiter1">Seperator:</label>
                    <select id="mappingDelimiter1">
                        <option value=";" selected>Puntkomma (;)</option>
                        <option value=",">Komma (,)</option>
                        <option value="\t">Tab</option>
                    </select>
                    <div style="height: 18px;"></div>
                    <label for="mappingDelimiter1">Kopregel:</label>
                    <select class="header-row-selector" id="headerRowSelector1" style="margin: 12px 0 8px 0; width:100%;"></select>
                    <div id="mappingPreview1" class="mapping-preview-wide"></div>
                </div>

                <div class="card mapping-file-block">
                    <span class="mapping-file-label">Bestand 2</span>
                    <input type="file" id="mappingFileInput2" accept=".csv,.xlsx,.xls">
                    <label for="mappingDelimiter2">Seperator:</label>
                    <select id="mappingDelimiter2">
                        <option value=";" selected>Puntkomma (;)</option>
                        <option value=",">Komma (,)</option>
                        <option value="\t">Tab</option>
                    </select>
                    <div style="height: 18px;"></div>
                    <label for="mappingDelimiter2">Kopregel:</label>
                    <select class="header-row-selector" id="headerRowSelector2" style="margin: 12px 0 8px 0; width:100%;"></select>
                    <div id="mappingPreview2" class="mapping-preview-wide"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- MAPPING POPUP -->
    <div id="mappingPopup" class="popup-overlay">
        <div class="popup-content card">
            <h3 class="popup-title">Kolommen mappen</h3>
            <div class="mapping-container">
                <div class="file-columns">
                    <h4>Bestand 1</h4>
                    <label class="dropdown-label">Koppelkolom:
                        <select id="joinKey1" class="styled-select"></select>
                    </label>
                    <div id="file1Columns"></div>
                </div>
                <div class="file-columns">
                    <h4>Bestand 2</h4>
                    <label class="dropdown-label">Koppelkolom:
                        <select id="joinKey2" class="styled-select"></select>
                    </label>
                    <label class="dropdown-label">Kolommen toevoegen:
                        <select id="columnsToAdd2" class="styled-select" multiple size="6"></select>
                    </label>
                    <div id="file2Columns"></div>
                </div>
            </div>
            <div class="mapping-buttons">
                <label>
                    <input type="checkbox" id="onlyMatchedRows" checked>
                    Alleen rijen met match exporteren
                </label>
                <button id="exportMappingButton">Export Mapped Data</button>
                <button id="closeMappingButton">Sluiten</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="pdf2excel.js"></script>
    <script src="app.js"></script>
</body>
</html>